# 服务器配置
# 生产环境使用8080端口
server.port=8081
server.servlet.context-path=/api
server.tomcat.uri-encoding=UTF-8

# 明确指定使用测试环境
spring.profiles.active=test

# 允许循环依赖（解决安全配置中的循环依赖问题）
spring.main.allow-circular-references=true

# MySQL数据库配置
spring.datasource.url=${DB_URL:jdbc:mysql://101.200.43.186:3306/umbrellazg?useSSL=false&serverTimezone=UTC}
spring.datasource.username=umbrellazg
spring.datasource.password=zhangge1121
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# 数据库连接池配置
# 调整max-lifetime为10分钟(600000ms)，解决连接验证失败问题
spring.datasource.hikari.max-lifetime=600000
# idle-timeout设为5分钟(300000ms)，小于max-lifetime
spring.datasource.hikari.idle-timeout=300000
# keepalive-time设为30秒(30000ms)，保持连接活跃
spring.datasource.hikari.keepalive-time=30000
# 增加连接池大小，解决线程饥饿问题
spring.datasource.hikari.maximum-pool-size=5
# 设置最小空闲连接数，使idleTimeout生效
spring.datasource.hikari.minimum-idle=1

# Redis配置
spring.data.redis.host=101.200.43.186
spring.data.redis.port=6379
spring.data.redis.database=0

# 日志配置
logging.level.root=INFO
logging.level.org.springframework.security=INFO
logging.level.com.website.backend=INFO
logging.level.com.website.backend.controller.ArticleController=INFO
logging.level.org.springframework.web=INFO
logging.level.org.springframework.boot=INFO
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{50} - %msg%n
# 输出日志到文件
logging.file.name=backend.log
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{50} - %msg%n
spring.data.redis.timeout=30000

# JWT配置
# 使用32字节(256位)的安全密钥，符合RFC 7518规范
app.jwtSecret=Y2F0Y2hlciUyMHdvcmxkJTIwZXhhbXBsZSUyMGp3dCUyMHNlY3JldF8xMjM0NTY=
app.jwtExpirationMs=43200000

# 文件上传配置
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=100MB

# 应用名称
spring.application.name=WebZG

# 文件存储路径
file.storage.path=./uploads

# 游客过期时间(毫秒)
app.guest.expirationMs=1800000